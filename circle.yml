machine:
  node:
    version: v8.2.0
dependencies:
  override:
    - lein deps
    # Install only test dependencies for start
    - npm install --only=dev
test:
  override:
    # Cljsjs - browser
    - lein with-profile test do clean, doo chrome client once
    - test -f out/cljsjs/react/development/react.inc.js
    # Cljsjs - Production build - Browser
    - lein with-profile prod-test do clean, doo chrome client once
    # Node Modules - Browser
    - npm install
    - lein with-profile test do clean, doo chrome-headless client once
    - test -f out/node_modules/react/react.js
    # Node Modules - Node Target
    - lein with-profile node-test do clean, doo node client once
    - test -f out/node_modules/react/react.js
